<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>

<body>

<div wicket:id="notifier"></div>
<div wicket:id="popupContainer">
    <div wicket:id="content"></div>
</div>

<div class="wrapper flex-column">

    <div wicket:id="menuPanel"></div>

    <div class="ui grid flex-1 workflow">
        <div class="vertical-left-menu">
            <a class="left-nav-item verticalItem active" wicket:id="servicesToggle">Services</a>
            <a class="left-nav-item verticalItem active" wicket:id="datasetsToggle">Datasets</a>
        </div>

        <div class="column flex-column-2 left-column">
            <div wicket:id="datasets" class="ui segment child-1 datasetsPanel" style="overflow-y: auto;"></div>
            <div wicket:id="services" class="ui segment child-1 servicesPanel" style="overflow-y: auto;"></div>
        </div>

        <div class="column flex-column-1 right-column">
            <div wicket:id="plumbContainer" id="plumbContainer" class="plumbContainer ui segment">
                <div wicket:id="canvasItem" class="canvas-item">
                    <div wicket:id="item"></div>
                </div>
                <div class="ui popup canvasItemPopup"></div>
            </div>

            <div wicket:id="jobs" class="ui segment child-1 jobsPanel"></div>

            <div wicket:id="visualizers" class="ui segment child-1 visualizersPanel"></div>
        </div>

        <div class="vertical-right-menu">
            <a class="right-nav-item verticalItem active" wicket:id="canvasToggle">Canvas</a>
            <a class="right-nav-item verticalItem active" wicket:id="jobsToggle">Jobs</a>
            <a class="right-nav-item verticalItem active" wicket:id="visualizersToggle">Visualizers</a>
        </div>

    </div>
    <div class="push"></div>
</div>

<div wicket:id="footerPanel"></div>

<script>
         var draggable = document.getElementById("datasetsDraggablesContainer");
         draggable.addEventListener('dragstart', dragStart, false);
         draggable.addEventListener('dragend'  , dragEnd  , false);

         draggable = document.getElementById("servicesDraggablesContainer");
         draggable.addEventListener('dragstart', dragStart, false);
         draggable.addEventListener('dragend'  , dragEnd  , false);

         var droptarget = document.getElementById("plumbContainer");
         droptarget.addEventListener('dragenter', dragEnter, false);
         droptarget.addEventListener('dragover', dragOver, false);
         droptarget.addEventListener('dragleave', dragLeave, false);
         droptarget.addEventListener('drop', drop, false);

         function dragStart(event) {
             event.dataTransfer.setData('draggableMarkupId', event.target.id);
             event.dataTransfer.setData('mouseOffsetX', event.layerX);
             event.dataTransfer.setData('mouseOffsetY', event.layerY)
             event.dataTransfer.dropEffect = "copy";
         }

         function dragEnd(event) {
         }

         function dragEnter(event) {
         }

         function dragOver(event) {
             event.preventDefault();
             return false;
         }

         function dragLeave(event) {
         }

         function drop(event) {
             var draggableMarkupId = event.dataTransfer.getData('draggableMarkupId');
             var mouseOffsetX = event.dataTransfer.getData('mouseOffsetX');
             var mouseOffsetY = event.dataTransfer.getData('mouseOffsetY');
             var el = document.getElementById(draggableMarkupId);
             var dropDataType = el.getAttribute("dropDataType");
             var dropDataId = el.getAttribute("dropDataId");

            var $el = $(el);
            var width = $el.width();
            var height = $el.height();

            var left = event.offsetX - mouseOffsetX;
            var top = event.offsetY - mouseOffsetY;
             event.preventDefault();
             onCanvasDrop(dropDataType, dropDataId, left, top, draggableMarkupId);
             return false;
         }

        var $allCards = $('.card');
        $allCards.each(function(){
            this.addEventListener("dragenter", handleDataItemsBoxDragEnter, false);
            this.addEventListener("dragleave", handleDragLeave, false);
            this.addEventListener("dragover", preventDefaultEventHandling, false);
            this.addEventListener("drop", dropOntoDataItem, false);
        });

        function handleDataItemsBoxDragEnter(event) {
                    event.stopPropagation();
                    event.preventDefault();
                    this.classList.add('over');
                    return false;
                }

        function preventDefaultEventHandling(event) {
            event.stopPropagation();
             event.preventDefault() ;
         }

        function handleDragLeave(event) {
                    event.stopPropagation();
                    event.preventDefault();
                    this.classList.remove('over');
                    return false;
                }

         function dropOntoDataItem(event) {
                    event.stopPropagation();
                    console.log('drop');
                    event.preventDefault();
                    this.classList.remove('over');
                    return false;
                   }
</script>

</body>
</html>